# Implementation Plan: Semantic Color System Upgrade

**Branch**: `007-semantic-colors` | **Date**: 2025-12-03 | **Spec**: [/specs/007-semantic-colors/spec.md](/specs/007-semantic-colors/spec.md)
**Input**: Feature specification from `/specs/007-semantic-colors/spec.md`

## Summary

Introduce **Secondary (Tonal)** and **Tertiary (Accent)** semantic surface layers into the design system to address the "Primary-heavy" visual imbalance and establish a richer visual hierarchy. Update the core `AppSurface` primitive to support new variants and enable interaction physics. Extend the `AppDesignTheme` contract across all five design languages (Glass, Brutal, Flat, Neumorphic, Pixel), then apply these changes to key components (`AppButton`, `AppNavigationBar`, `AppTag`) to demonstrate clear visual distinction between critical actions, secondary states, and base content. Ensure regression safety through comprehensive golden test coverage across the 8-style matrix (4 themes × 2 brightness modes).

## Technical Context

**Language/Version**: Dart 3.8.0+ and Flutter 3.32.0+
**Primary Dependencies**:
  - Flutter framework (widgets, animation, material color schemes)
  - `theme_tailor_annotation` & `theme_tailor` (theme code generation)
  - `flutter_animate` (existing micro-interaction engine)
  - `alchemist` (golden test framework)
**Storage**: In-memory theme state (Flutter ThemeExtension via MediaQuery)
**Testing**: Alchemist golden tests with 8-style matrix validation
**Target Platform**: Mobile + Desktop (Flutter multi-platform)
**Project Type**: Single package library (`lib/src/` directory in repository root)
**Performance Goals**: Zero perceptible latency in theme switching; golden tests must complete in < 5 minutes for all 8 styles
**Constraints**:
  - Backward compatibility with existing components
  - No new external dependencies
  - All changes must follow Atomic Design and theme tailor patterns
  - Physics-based consistency across all design languages
**Scale/Scope**:
  - 1 foundation update (theme contract)
  - 1 primitive update (AppSurface)
  - 3 component updates (AppButton, AppNavigationBar, AppTag)
  - 5 theme implementations (Glass, Brutal, Flat, Neumorphic, Pixel)
  - ~24 new golden test scenarios (3 components × 4 themes × 2 modes)

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

**Status**: ✅ PASS (Version 2.0.0 confirmed)

**Gate Evaluation**:
- ✅ **Inversion of Control (3.1)**: Components ask theme "How should I render Tonal?" not "Who are you?" Variants are data-driven, not style-checking logic
- ✅ **Data-Driven Strategy (3.2)**: New surfaces are defined as `SurfaceStyle` specs in the theme, not hard-coded conditionals
- ✅ **Semantic Architecture (4.3)**: Variables named for usage (`surfaceSecondary`, `surfaceTertiary`), not appearance (`blueBackground`, `greenBorder`)
- ✅ **Theme Tailor (4.4)**: All specs use `@TailorMixin()` for automatic code generation
- ✅ **AppSurface Composition (5.1)**: All components using new surfaces compose `AppSurface` with variant parameters
- ✅ **Primitive Rendering (5.2)**: `AppSurface` is the sole renderer for all surfaces and physics
- ✅ **No Runtime Type Checks (6.1)**: Component logic does not check theme type; surfaces are theme-agnostic
- ✅ **Multi-Theme Consistency (5.1)**: All five design languages must implement surfaceSecondary and surfaceTertiary
- ✅ **Golden Tests (12.2)**: Comprehensive matrix ensures all styles are visually validated

**Constitution Notes**:
- Feature strictly adheres to Constitution v2.0.0 (Composition section, Multi-Paradigm support)
- The new semantic surfaces strengthen the "Data-Driven Strategy" by adding middle-tier visual distinction without requiring component-level conditional logic
- All changes respect the "Single Source of Truth" principle: AppDesignTheme is the sole arbiter of visual hierarchy

## Project Structure

### Documentation (this feature)

```text
specs/007-semantic-colors/
├── spec.md                  # Feature specification (user scenarios, requirements, success criteria)
├── plan.md                  # This file (implementation approach)
├── research.md              # Phase 0: Resolved unknowns and design decisions
├── data-model.md            # Phase 1: Entity definitions (SurfaceStyle enhancements, theme contract)
├── quickstart.md            # Phase 1: Developer quick-start guide
├── contracts/               # Phase 1: API/contract specifications (optional for this feature)
├── checklists/
│   └── requirements.md      # Quality checklist (PASSED ✅)
└── tasks.md                 # Phase 2: Actionable tasks (generated by /speckit.tasks command)
```

### Source Code (repository root)

```text
lib/src/
├── foundation/
│   ├── theme/
│   │   ├── design_system/
│   │   │   ├── app_design_theme.dart          # UPDATED: Add surfaceSecondary, surfaceTertiary
│   │   │   ├── specs/
│   │   │   │   └── surface_style.dart         # (Existing; used as-is)
│   │   │   └── styles/
│   │   │       ├── glass_design_theme.dart    # UPDATED: Define Tonal surface (tinted frost)
│   │   │       ├── brutal_design_theme.dart   # UPDATED: Define Tonal surface (grey/halftone)
│   │   │       ├── flat_design_theme.dart     # UPDATED: Define Tonal surface (pale color)
│   │   │       ├── neumorphic_design_theme.dart # UPDATED: Define Tonal surface (shallow convex)
│   │   │       └── pixel_design_theme.dart    # UPDATED: Define Tonal surface (pixel-style)
│   │   └── tokens/
│   │       └── app_palette.dart               # UPDATED: Add secondary & tertiary color tokens
├── atoms/
│   └── surfaces/
│       └── app_surface.dart                   # CRITICAL: Add variant enum + interaction physics
├── molecules/
│   ├── buttons/
│   │   └── app_button.dart                    # UPDATED: Support variant="tonal"
│   ├── navigation/
│   │   └── app_navigation_bar.dart            # UPDATED: Add pill-shaped Tonal indicator
│   ├── display/
│   │   └── app_tag.dart                       # UPDATED: Add isSelected param → auto Tonal
│   └── ... (other molecules, unchanged)
└── ... (other atoms, organisms, layout unchanged)

test/
├── molecules/
│   ├── buttons/
│   │   └── app_button_golden_test.dart        # UPDATED: Add Tonal variant scenarios (24 new tests: 3 components × 4 themes × 2 modes)
│   ├── navigation/
│   │   └── app_navigation_bar_golden_test.dart # UPDATED: Add pill indicator scenarios
│   ├── display/
│   │   └── app_tag_golden_test.dart           # UPDATED: Add selected state scenarios
│   └── ... (other tests, unchanged)
└── ... (atoms, organisms tests unchanged)

widgetbook/
└── lib/
    └── widgetbook.dart                         # UPDATED: Dashboard demo showcases full hierarchy
```

**Structure Decision**:
This is a **single package library** with focused, layered changes:
1. **Foundation Layer** (theme contract + tokens): Enables new semantic roles
2. **Primitive Layer** (AppSurface): Delivers interaction physics and variant resolution
3. **Component Layer** (AppButton, AppNavigationBar, AppTag): Demonstrates user value
4. **Testing Layer** (golden tests): Validates visual consistency across all styles

Changes are **strictly backward compatible**: existing components continue to function without modification; new functionality is opt-in via variant parameters.

## Complexity Tracking

**Status**: ✅ COMPLIANT — Design adheres to Constitution v2.0.0 constraints.

**Constraints & Trade-offs**:
- **AppSurface Primitive (5.1)**: All new components using Tonal surfaces **must** compose `AppSurface` with appropriate variant. No exceptions for custom containers.
- **Physics Implementation (5.2)**: Interaction physics (scale, glow) are implemented in `AppSurface._AppSurfaceState` using `AnimatedScale` + `GestureDetector`, not in individual components.
- **Theme Consistency**: Each design language must define all three surfaces (Base, Tonal/Secondary, Highlight) with internally consistent visual properties.
- **Golden Test Matrix**: All new components must pass the 8-style matrix (4 themes × 2 brightness modes). Pixel theme is included even though not mentioned in original spec, for completeness.

---

## Phase 0: Research & Validation

**Objective**: Resolve technical unknowns and validate design approach for the five themes.

### Research Topics

1. **AppSurface Interaction Physics Implementation**
   - Confirm that `AnimatedScale` + `GestureDetector` approach is optimal for press feedback
   - Determine if interaction spec should include additional physics (rotation, blur, offset)
   - Verify that pressed scale factor (e.g., 0.97) applies consistently across all themes
   - **Expected Outcome**: Documented physics strategy in `research.md`

2. **Glass Theme Tonal Definition (Tinted Frost)**
   - Determine optimal alpha values for `primary.withValues(alpha: X)` across Light/Dark modes
   - Verify blur strength (15.0) creates perceptible "denser glass" effect vs. base
   - Test border color selection (white vs. primary tint) for clarity
   - **Expected Outcome**: Tested values for all Glass variants in `research.md`

3. **Brutal Theme Tonal Definition (Mechanical)**
   - Decide between solid grey fill vs. halftone dot pattern
   - Confirm border width (2.0) is visually distinct from Base and Highlight
   - Verify zero border radius maintains mechanical aesthetic
   - **Expected Outcome**: Design specification for Brutal Tonal surfaces in `research.md`

4. **Flat & Neumorphic Theme Consistency**
   - Validate that Material 3's `secondaryContainer` color is appropriate for Flat theme
   - Confirm Neumorphic "shallow convex" shadow settings create clear elevation distinction
   - **Expected Outcome**: Shadow/color values documented in `research.md`

5. **Pixel Theme Support**
   - Design pixel-art appropriate Tonal surface (may use pixelation effect or grid pattern)
   - Ensure consistency with existing Pixel theme aesthetic
   - **Expected Outcome**: Pixel theme implementation spec in `research.md`

6. **Golden Test Stability**
   - Verify alchemist test framework handles all 8-style combinations without flakiness
   - Confirm test isolation (Safe Mode Protocol from Constitution 12.2) applies to new tests
   - **Expected Outcome**: Test structure + golden baseline files in `research.md`

### Phase 0 Deliverables

- `research.md`: Technical findings, design decisions, and rationale for each theme
- Confirmed visual definitions for all 5 themes' Tonal surfaces
- Golden test strategy and Safe Mode Protocol application

---

## Phase 1: Design & Contracts

**Prerequisites**: `research.md` complete with visual definitions confirmed

### 1.1 Foundation Layer Updates

#### Task: Update Tokens (`lib/src/foundation/theme/tokens/app_palette.dart`)

Define static color tokens for new semantic levels. These tokens serve as the source for all theme implementations.

```dart
class AppPalette {
  // ... existing primary, secondary, tertiary tokens ...

  // New tokens for Tonal containers (Material 3 inspired)
  static const Color secondaryContainer = Color(0xFFDCE3F0); // Light
  static const Color onSecondaryContainer = Color(0xFF1E2A3A);

  static const Color tertiaryContainer = Color(0xFFFFD8E4);
  static const Color onTertiaryContainer = Color(0xFF3E1F2F);

  // Dark mode variants
  static const Color secondaryContainerDark = Color(0xFF314561);
  static const Color onSecondaryContainerDark = Color(0xFFE0E8F8);
}
```

#### Task: Update `SurfaceVariant` Enum (`lib/src/atoms/surfaces/app_surface.dart`)

Expand enum to include new semantic variants:

```dart
enum SurfaceVariant {
  base,       // Low emphasis (Card background)
  elevated,   // High emphasis (Dialog, Modal)
  highlight,  // Max emphasis (Primary Button, CTA)
  tonal,      // Medium emphasis (Selected state, Secondary Button)
  accent,     // Decorative / Special state (Future expansion)
}
```

#### Task: Extend Theme Contract (`lib/src/foundation/theme/design_system/app_design_theme.dart`)

Add new surface properties to `AppDesignTheme`:

```dart
@TailorMixin()
class AppDesignTheme extends ThemeExtension<AppDesignTheme> with _$AppDesignThemeTailorMixin {
  // Existing surfaces
  final SurfaceStyle surfaceBase;
  final SurfaceStyle surfaceElevated;
  final SurfaceStyle surfaceHighlight;

  // New surfaces
  final SurfaceStyle surfaceSecondary;  // Maps to SurfaceVariant.tonal
  final SurfaceStyle surfaceTertiary;   // Maps to SurfaceVariant.accent

  // ... rest of theme properties ...

  const AppDesignTheme({
    required this.surfaceBase,
    required this.surfaceElevated,
    required this.surfaceHighlight,
    required this.surfaceSecondary,
    required this.surfaceTertiary,
    // ... other required properties ...
  });

  // Theme tailor auto-generates copyWith, lerp, etc.
}
```

**Note**: After updating the contract, run `dart run build_runner build --delete-conflicting-outputs` to regenerate the `.tailor.dart` file.

### 1.2 Theme Implementations

**Task**: Implement surfaceSecondary and surfaceTertiary for each design language.

Each implementation file (`glass_design_theme.dart`, `brutal_design_theme.dart`, etc.) must define these surfaces according to the theme's visual language.

**GlassDesignTheme**:
- Light: `backgroundColor: scheme.primary.withValues(alpha: 0.12)`, blur: 15, border: white with alpha 0.3
- Dark: `backgroundColor: scheme.primary.withValues(alpha: 0.25)`
- Visual intent: "Denser glass" indicating selection

**BrutalDesignTheme**:
- `backgroundColor: scheme.surfaceContainerHigh` (grey solid or halftone pattern)
- `borderColor: scheme.onSurface` (thick black border)
- `borderWidth: 2.0` (thinner than Highlight's 3.0)
- Visual intent: Mechanical "pressed" state

**FlatDesignTheme**:
- `backgroundColor: scheme.secondaryContainer`
- `contentColor: scheme.onSecondaryContainer`
- Visual intent: Material 3 Tonal Container

**NeumorphicDesignTheme**:
- `backgroundColor: scheme.surface`
- Shallow convex shadows (lower blur, smaller offset than Elevated)
- Visual intent: Subtle tactile lift

**PixelDesignTheme**:
- Pixel-art appropriate aesthetic (grid pattern or pixelated fill)
- Consistent with existing Pixel theme style

### 1.3 Critical Primitive Update: AppSurface

**Task**: Update `AppSurface` to support variant resolution AND implement interaction physics.

This is the **critical path** task; it unblocks all component updates.

```dart
class AppSurface extends StatefulWidget {
  const AppSurface({
    super.key,
    this.child,
    this.style,
    this.variant = SurfaceVariant.base,
    this.onTap,
    this.interactive = false,
    // ... existing dimension parameters ...
  });

  final Widget? child;
  final SurfaceStyle? style;
  final SurfaceVariant variant;
  final VoidCallback? onTap;
  final bool interactive;

  @override
  State<AppSurface> createState() => _AppSurfaceState();
}

class _AppSurfaceState extends State<AppSurface> with SingleTickerProviderStateMixin {
  late AnimationController _controller;
  bool _isPressed = false;

  @override
  void initState() {
    super.initState();
    _controller = AnimationController(vsync: this);
  }

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context).extension<AppDesignTheme>()!;
    final effectiveStyle = widget.style ?? _resolveStyle(theme, widget.variant);

    _controller.duration = theme.animation.duration;

    // Physics: Determine scale during press
    final scale = _isPressed
        ? (effectiveStyle.interaction?.pressedScale ?? 1.0)
        : 1.0;

    return GestureDetector(
      onTap: widget.onTap,
      onTapDown: (widget.interactive || widget.onTap != null)
          ? (_) => setState(() => _isPressed = true)
          : null,
      onTapUp: (_) => setState(() => _isPressed = false),
      onTapCancel: () => setState(() => _isPressed = false),

      child: AnimatedScale(
        scale: scale,
        duration: theme.animation.duration,
        curve: theme.animation.curve,
        child: AnimatedContainer(
          duration: theme.animation.duration,
          curve: theme.animation.curve,
          decoration: BoxDecoration(
            color: effectiveStyle.backgroundColor,
            border: Border.all(
              color: effectiveStyle.borderColor,
              width: effectiveStyle.borderWidth
            ),
            borderRadius: BorderRadius.circular(effectiveStyle.borderRadius),
            boxShadow: effectiveStyle.shadows,
          ),
          child: DefaultTextStyle(
            style: TextStyle(color: effectiveStyle.contentColor),
            child: IconTheme(
              data: IconThemeData(color: effectiveStyle.contentColor),
              child: widget.child ?? const SizedBox.shrink(),
            ),
          ),
        ),
      ),
    );
  }

  SurfaceStyle _resolveStyle(AppDesignTheme theme, SurfaceVariant variant) {
    switch (variant) {
      case SurfaceVariant.base:
        return theme.surfaceBase;
      case SurfaceVariant.elevated:
        return theme.surfaceElevated;
      case SurfaceVariant.highlight:
        return theme.surfaceHighlight;
      case SurfaceVariant.tonal:
        return theme.surfaceSecondary;
      case SurfaceVariant.accent:
        return theme.surfaceTertiary;
    }
  }
}
```

### 1.4 Component Updates

#### Task: `AppButton` (Add Tonal Variant Support)

Update button logic to handle the new variant:

```dart
class AppButton extends StatelessWidget {
  final SurfaceVariant variant;
  // ... other properties ...

  @override
  Widget build(BuildContext context) {
    final targetVariant = variant; // Can be base, tonal, highlight, etc.

    return AppSurface(
      variant: targetVariant,
      onTap: onPressed,
      interactive: true,
      child: Center(
        child: AppText(text: label, style: /* compute from theme */),
      ),
    );
  }
}
```

#### Task: `AppNavigationBar` (Add Pill Indicator)

Update selected item rendering to use Tonal background:

```dart
// In _NavigationItem builder:
final isSelected = index == currentIndex;

return Expanded(
  child: GestureDetector(
    onTap: () => onIndexChanged(index),
    child: Column(
      mainAxisAlignment: MainAxisAlignment.center,
      children: [
        // Pill-shaped Tonal indicator for selected item
        AppSurface(
          variant: isSelected ? SurfaceVariant.tonal : SurfaceVariant.base,
          style: isSelected
              ? theme.surfaceSecondary
              : theme.surfaceBase.copyWith(
                  backgroundColor: Colors.transparent,
                  borderWidth: 0
                ),
          borderRadius: 99.0, // Force capsule shape
          height: 32.0 * theme.spacingFactor,
          width: 64.0 * theme.spacingFactor,
          child: Center(
            child: IconTheme(
              data: IconThemeData(
                color: isSelected ? theme.surfaceSecondary.contentColor : Colors.grey
              ),
              child: item.icon,
            ),
          ),
        ),
        SizedBox(height: 4.0 * theme.spacingFactor),
        AppText(text: item.label, style: /* compute from theme */),
      ],
    ),
  ),
);
```

#### Task: `AppTag` (Add Selected State)

Add `isSelected` parameter that auto-switches to Tonal:

```dart
class AppTag extends StatelessWidget {
  final String label;
  final bool isSelected;
  // ... other properties ...

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context).extension<AppDesignTheme>()!;

    // Logic: Selected → Tonal, Unselected → Base
    final targetVariant = isSelected ? SurfaceVariant.tonal : SurfaceVariant.base;

    return AppSurface(
      variant: targetVariant,
      borderRadius: 16.0,
      padding: EdgeInsets.symmetric(horizontal: 12.0, vertical: 6.0),
      child: AppText(text: label, style: /* compute from theme */),
    );
  }
}
```

### 1.5 Golden Tests

**Task**: Update and create golden test files for new Tonal scenarios.

Each test file covers the 8-style matrix (4 themes × 2 brightness modes):

- `test/molecules/buttons/app_button_golden_test.dart`: Add scenarios for `variant: SurfaceVariant.tonal`
- `test/molecules/navigation/app_navigation_bar_golden_test.dart`: Add scenarios for selected item with pill indicator
- `test/molecules/display/app_tag_golden_test.dart`: Add scenarios for `isSelected: true`

Example test structure using alchemist:

```dart
void main() {
  group('AppButton Golden Tests', () {
    testWidgets('Tonal variant renders correctly in Glass Light', (tester) async {
      await tester.binding.window.physicalSizeTestValue = const Size(400, 600);
      addTearDown(tester.binding.window.clearPhysicalSizeTestValue);

      await tester.pumpWidget(
        MaterialApp(
          theme: ThemeData(extensions: [glassLightTheme()]),
          home: const Scaffold(
            body: AppButton(
              label: 'Save Draft',
              variant: SurfaceVariant.tonal,
            ),
          ),
        ),
      );

      await expectGoldenMatches(
        find.byType(AppButton),
        'golden_app_button_tonal_glass_light.png',
      );
    });

    // ... repeat for all 8 styles ...
  });
}
```

### 1.6 Widgetbook Updates

**Task**: Update Dashboard demo to showcase full visual hierarchy.

```dart
// In widgetbook/lib/widgetbook.dart Dashboard page:
class DashboardPage extends StatefulWidget {
  @override
  State<DashboardPage> createState() => _DashboardPageState();
}

class _DashboardPageState extends State<DashboardPage> {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Column(
        children: [
          // Highlight: "Add Device" primary action
          AppButton(
            label: 'Add Device',
            variant: SurfaceVariant.highlight,
            onPressed: () {},
          ),

          // Tonal: "Save Draft" secondary action
          AppButton(
            label: 'Save Draft',
            variant: SurfaceVariant.tonal,
            onPressed: () {},
          ),

          // Base: Low-priority elements
          AppButton(
            label: 'Cancel',
            variant: SurfaceVariant.base,
            onPressed: () {},
          ),

          // Navigation with Tonal selection indicator
          AppNavigationBar(
            items: [/* ... */],
            currentIndex: 0,
          ),

          // Tags with selection state
          Wrap(
            children: [
              AppTag(label: 'Wifi', isSelected: true),
              AppTag(label: 'Ethernet', isSelected: false),
              AppTag(label: 'Bluetooth', isSelected: true),
            ],
          ),
        ],
      ),
    );
  }
}
```

### 1.7 Code Generation

**Task**: Run build runner to generate theme tailor code.

```bash
dart run build_runner build --delete-conflicting-outputs
```

This generates:
- `app_design_theme.tailor.dart` (updated with new surface properties)
- `surface_style.tailor.dart` (if SurfaceStyle uses @TailorMixin)
- All other spec `.tailor.dart` files

### 1.8 Contracts (Optional for this feature)

Since this feature is purely UI-internal (no API changes), formal contracts are not required. However, document the new properties:

- `surfaceSecondary: SurfaceStyle` - Represents medium-emphasis surface for selected/tonal states
- `surfaceTertiary: SurfaceStyle` - Represents decorative/accent surface for special states
- `SurfaceVariant.tonal` - Enum value mapping to `surfaceSecondary`
- `SurfaceVariant.accent` - Enum value mapping to `surfaceTertiary`

---

## Phase 1 Deliverables

- ✅ `research.md`: Visual definitions for all 5 themes' Tonal surfaces, physics strategy confirmed
- ✅ `data-model.md`: Updated entity definitions (AppDesignTheme, SurfaceVariant, SurfaceStyle)
- ✅ `quickstart.md`: Developer guide for using new Tonal surfaces
- ✅ Updated source code: All 1.1–1.8 tasks completed
- ✅ Agent context updated (via `update-agent-context.sh claude` script)

---

## Phase 2: Implementation & Testing (Next Step)

**Objective**: Execute the plan and validate against success criteria.

### Phase 2 Tasks

1. **Build & Test**: `flutter test` + `flutter test --update-goldens --tags golden`
2. **Manual Verification**: Open widgetbook and verify Dashboard visual hierarchy
3. **Theme Switching**: Manually switch between all 5 themes in widgetbook and confirm all surfaces render correctly
4. **Regression Testing**: Run full test suite to confirm no existing components are broken
5. **Golden Test Review**: Compare golden diffs to specification visual definitions

### Expected Outcomes

- All 24 golden tests pass (3 components × 4 themes × 2 modes, or extended to all affected components)
- Dashboard demo clearly demonstrates 3-tier visual hierarchy (Base, Tonal, Highlight)
- Zero regressions in existing components
- Code compiles without warnings

---

## Success Criteria (From Spec)

✅ **SC-001**: Dashboard demo displays unmistakable visual separation (Base → Tonal → Highlight)
✅ **SC-002**: AppButton Tonal variant renders correctly across all 4 themes in Light/Dark
✅ **SC-003**: AppNavigationBar selected item shows pill-shaped Tonal indicator immediately
✅ **SC-004**: AppTag with `isSelected=true` automatically switches to Tonal surface
✅ **SC-005**: All 24 golden tests pass without regressions
✅ **SC-006**: Tonal surfaces respect design language physics (Glass blur, Brutal borders, etc.)
✅ **SC-007**: Theme tailor generates code seamlessly with new surfaces
✅ **SC-008**: Developers adopt new surfaces within 10 minutes
✅ **SC-009**: Visual noise reduced in dashboard demo

---

## Risk Mitigation

| Risk | Mitigation |
|------|-----------|
| **Golden test flakiness across all 8 styles** | Use alchemist Safe Mode Protocol (fixed sizes, visibility checks); run tests multiple times before finalizing |
| **Theme tailor code generation errors** | Test code generation in isolation first before component integration |
| **Visual inconsistency between themes** | Review each theme implementation with spec visual definitions; iterate with widgetbook preview |
| **Backward compatibility breakage** | Ensure existing components continue to work; new functionality is opt-in via variant parameters |
| **Performance regression from new animation** | Profile golden tests; ensure press animation completes within 16ms |

---

## Next Steps

1. ✅ Phase 1 complete (this plan document)
2. Run `/speckit.tasks` to generate `tasks.md` with actionable task list
3. Execute Phase 2 implementation tasks
4. Validate against success criteria
5. Create commit with golden test golden files + source code
6. Open PR for review
