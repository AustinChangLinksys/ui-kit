<!--
Sync Impact Report:
  Version change: 1.0.0 -> 1.1.0
  List of modified principles: 3.3 Automation & Tooling
  Added sections: None
  Removed sections: None
  Templates requiring updates:
    - .specify/templates/plan-template.md: ⚠ pending
    - .specify/templates/spec-template.md: ⚠ pending
    - .specify/templates/tasks-template.md: ⚠ pending
    - .specify/commands/speckit.analyze.toml: ⚠ pending
    - .specify/commands/speckit.checklist.toml: ⚠ pending
    - .specify/commands/speckit.clarify.toml: ⚠ pending
    - .specify/commands/speckit.constitution.toml: ⚠ pending
    - .specify/commands/speckit.implement.toml: ⚠ pending
    - .specify/commands/speckit.plan.toml: ⚠ pending
    - .specify/commands/speckit.specify.toml: ⚠ pending
    - .specify/commands/speckit.tasks.toml: ⚠ pending
    - .specify/commands/speckit.taskstoissues.toml: ⚠ pending
  Follow-up TODOs: None
-->
# Project Constitution: UI Kit

This document outlines the core principles, architectural guidelines, and quality standards for the UI Kit library.

## 1. Vision & Scope
This library aims to provide a set of High Cohesion, Logic-Free, and Theme-Driven UI components. It serves as the Single Source of Truth for the application's visual presentation.

Scope: Atomic components (Atoms), Composite components (Molecules), Style definitions (Theming), Icon assets (Assets), and Basic layout logic (Layout).

Out of Scope: API connectivity, State Management (Bloc/Provider), Routing logic, and Business Data Models.

## 2. Architectural Boundaries
### 2.1 Physical Isolation
This library must exist as an Independent Dart Package to enforce physical decoupling.

### 2.2 Dependency Hygiene
❌ Forbidden: It is strictly forbidden to depend on packages containing business logic or backend connectivity, such as bloc, provider, riverpod, http, dio, firebase, or shared_preferences.

✅ Allowed: UI and utility packages only, such as flutter, intl (formatting), vector_math, google_fonts, flutter_svg, rive, theme_tailor, flutter_animate, and flutter_gen.

### 2.3 Directory Structure
Adopts a variant of Atomic Design:

src/foundation/: Base styles (Colors, Typography, Spacing).

src/atoms/: Indivisible units (Button, Icon, Badge).

src/molecules/: Simple compositions (ListTile, InputField).

src/organisms/: Complex sections (AppBar, ProductCard).

src/layout/: Responsive layout utilities.

## 3. Theming & Styling
### 3.1 Token-First Design
No Hardcoding: It is strictly forbidden to use Color(0xFF...), Colors.red, or hardcoded TextStyle within UI components.

Access Pattern: All styles must be accessed via Theme.of(context) to ensure Dynamic Color support.

### 3.2 Semantic Architecture
Intent over Appearance: ThemeExtension variables must describe "usage" (e.g., success, critical, surfaceContainer) and must not describe "appearance" (e.g., green, orange).

Extension Mechanism: When the standard Material 3 ColorScheme is insufficient, extend it by inheriting from ThemeExtension.

### 3.3 Automation & Tooling
Theme Tailor: The theme_tailor package must be used to generate ThemeExtension classes. The `@TailorMixin` annotation (replacing the deprecated `@Tailor`) must be used for automatic generation. Handwritten copyWith and lerp methods are prohibited to reduce maintenance errors.

### 3.4 Dynamic Theme Factory
Static ThemeData constants are prohibited. A Factory method (e.g., AppTheme.create({Color? seed})) must be provided to allow the main application to inject a Seed Color for Dynamic Color support.

### 3.5 Typography
Follow the DRY Principle. Establish a unified BaseTextStyle to manage fontFamily and package paths. Repeating font parameters in individual styles is prohibited.

## 4. Component Design
### 4.1 Dumb Components
Components receive data solely via the Constructor and pass events via Callbacks (VoidCallback, ValueChanged).

Components must not hold any business state; only UI transient state (e.g., ScrollOffset, AnimationController) is allowed.

### 4.2 Composition over Inheritance
Utilize the Slots Pattern by reserving parameters like child, leading, trailing, and content.

Avoid creating sub-classes like MyRedButton; instead, use style objects, e.g., MyButton(style: MyButtonStyle.danger()).

## 5. Assets Management
### 5.1 Access Standards
Strong Typing: String paths are strictly forbidden. Access must be done via objects generated by flutter_gen (e.g., MyAssets.icons.home) to ensure correct Package paths.

### 5.2 Formatting Standards
Icons: Use SVG format. Color attributes (fill) must be removed from the file and controlled externally via IconTheme.

Product Images: Prioritize WebP format to balance quality and file size.

Dark Mode Adaptation:

Monochrome Icons: Use ColorFilter to change colors.

Photorealistic Product Images: Color swapping is prohibited. Use ColorFiltered to apply a semi-transparent black overlay (Dimming) to reduce brightness and avoid glare.

## 6. Animation Strategy
### 6.1 Technology Stack
Level 1 (Micro-interactions): Use flutter_animate or native Code for UI transitions.

Level 2 (State-Driven): Complex state icons (e.g., router lights, connection flows) must use Rive (.riv).

Prohibition: Due to file size and maintenance costs, Lottie is not used in this project.

### 6.2 Rive Standards
Must utilize State Machines to encapsulate multiple states within a single file, reducing resource fragmentation.

Must be exported in the binary .riv format.

## 7. Layout & Responsiveness
### 7.1 No Singletons
Strictly Forbidden: Do not use Singletons to store screen dimensions or calculation results. All layout calculations must rely on BuildContext and MediaQuery.

### 7.2 Centralized Configuration
Breakpoints, Columns, and Gutters must be defined in ThemeExtension (AppLayout) rather than scattered across Widgets.

### 7.3 Developer Experience
Provide BuildContext Extension Methods (e.g., context.col(6), context.isDesktop) to simplify call logic.

## 8. Accessibility (a11y)
### 8.1 Semantics
All custom interactive components must be wrapped in a Semantics Widget with correctly declared label, value, and onTap properties.

### 8.2 Touch Targets
Clickable areas on mobile devices must be at least 44x44 (iOS) or 48x48 (Android) logical pixels.

## 9. Internationalization (i18n)
### 9.1 No-String Policy
The library must not contain hardcoded display text. All labels must be passed in via parameters from the outside.

### 9.2 RTL Support
Layout properties must use Directionality-safe syntax (e.g., use EdgeInsetsDirectional.start instead of EdgeInsets.left).

## 10. Performance
Repaint Boundary: Frequently changing components (e.g., Loading spinners) must be wrapped in RepaintBoundary.

Expensive Operations: Use Opacity cautiously (prefer FadeTransition) and limit the use of BackdropFilter.

## 11. Versioning
Semantic Versioning: Strictly adhere to SemVer (X.Y.Z). Breaking Changes require a Major version (X) bump.

Deprecation Policy: Mark APIs with @Deprecated before removal and retain them for at least one Minor version transition period.

## 12. Quality Assurance & Testing
### 12.1 Widgetbook
Mandatory: All public components must have registered UseCases in Widgetbook with Knobs configured for designer review.

### 12.2 Golden Tests
Testing Matrix: Core components must include screenshot tests covering the following dimensions:

Theme: Light Mode / Dark Mode.

Text Scale: Standard (1.0) / Accessibility (1.5).

Zero Overflow Standard: Under 1.5x text scaling, test screenshots must not show overflow warnings (Yellow/Black stripes), and text must not obscure critical operation areas.

## 13. Governance
### 13.1 Constitution Version
1.1.0

### 13.2 Ratification Date
2025-11-27

### 13.3 Last Amended Date
2025-11-27

### 13.4 Amendment Procedure
Amendments to this constitution require a consensus among core maintainers. Proposed changes must be thoroughly documented, reviewed, and approved before being incorporated. Minor clarifications and typo fixes may be applied by any maintainer.

### 13.5 Compliance Review
Adherence to these principles will be reviewed periodically during code reviews, architectural discussions, and sprint retrospectives. Non-compliance must be addressed and resolved promptly.